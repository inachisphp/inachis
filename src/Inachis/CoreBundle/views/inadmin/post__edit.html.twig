{% extends "admin__structure__main.html.twig" %}
{% block content %}

<form action="/inadmin/post/new" method="post" class="form form__post">
	<div class="col span_8_of_8 ui-tabbed">
		<ul>
			<li>
				<a href="#post__edit">Content</a>
			</li>
			<li>
				<a href="#post__properties">Properties</a>
			</li>
		</ul>
		<fieldset id="post__edit">
			<legend>Edit Post</legend>
			<p>
				<a class="material-icons ui-toggle" href="#" data-target=".post__link__edit" data-target-state="hidden">link</a> 
				<label for="title">Title</label>
				<input id="title" name="title" type="text" autofocus placeholder="e.g. My First Blog Post" required value="{{ post.title }}" />
			</p>
			<p>
				<label for="subTitle">Sub-title</label>
				<input id="subTitle" name="subTitle" placeholder="(optional)" type="text" value="{{ post.subTitle }}" />
			</p>
			<p class="post__link__edit">
				<label for="url">URL</label>
				{{ settings.domain }}/<input class="" id="url" name="url" type="url" value="" />
			</p>
			<p>
				<textarea name="content" name="content">{{ post.content }}</textarea>
			</p>
		</fieldset>

		<fieldset id="post__properties">
			<legend>Properties</legend>
			<p>
				<label for="visibility">Visibility</label>
				<span class="switch-wrapper">
					<input class="ui-switch" data-label-off="private" data-label-on="public" id="visibility" name="visibility" type="checkbox" />
				</span>
			</p>
			<p>
				<label for="publishDate">
					Publish{% if post.publishDate is not empty and date(post.publishDate) <= date() %}ed{% endif %} on
				</label>
				<span id="post__schedule__timed">
					<input id="publishDate" name="publishDate__date" value="{{ post.publishDate|date('Y/m/d H:i') }}" type="text" />
				</span>
			</p>
			<h3>Categories</h3>
			<ul id="category-list" data-name="categories">
			</ul>
			<p>
				<label for="tags">Tags</label>
				<select class="js-select" data-tags="true" id="tags" name="tags" multiple>
				</select>
			</p>
			<p>
				<label for="latlong">Location</label>
				<input class="ui-map" data-google-key="{{ settings.google.key }}" id="latlong" name="latlong" type="text" value="{{ post.latlong }}" />
			</p>
			<h3>Feature Details</h3>
			<p>
				<label for="featureSnippet">Snippet</label>
				<textarea id="featureSnippet" name="featureSnippet">{{ post.featureSnippet }}</textarea>

				<label for="featureImage">Image</label>
				<input id="featureImage" name="featureImage" type="text" value="{{ post.featureImage }}" />
			</p>
			<h3>Sharing</h3>
			<!-- loop through services / accounts for checkboxes + add char counter below for ui-counter -->
			<p>
				<label for="sharingMessage">Message</label>
				<textarea class="ui-counter" name="sharingMessage" id="sharingMessage"></textarea>
			</p>
		</fieldset>
	</div>
	<div class="fixed-bottom-bar">
		<p>
			<button type="submit" class="button button--positive">Save</button>
			<button type="submit" class="button button--info">{% if post.publishDate > date() %}Schedule{% else %}Publish{% endif %}</button>
			<button type="submit" class="button button--negative">Delete</button>
		</p>
	</div>
</form>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<link rel="stylesheet" href="/inadmin/assets/css/jquery.switchButton.css">
<link rel="stylesheet" href="/inadmin/assets/css/jquery.datetimepicker.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script src="/inadmin/assets/js/jquery.switchButton.js"></script>
<script src="/inadmin/assets/js/jquery.datetimepicker.full.min.js"></script>
<script>
var simplemde = new SimpleMDE({
	element: $("#content")[0],
	autosave: {
		enabled: true,
		uniqueId: '{% if post.id is not empty %}{{ post.id }}{% else %}new-content-{{ session.user.id }}-{{ date()|date('Ymd') }}{% endif %}'
	},
	forceSync: true
});
</script>
{% endblock content %}
