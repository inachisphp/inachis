<input class="filepond"
    id="{{ paramName|replace({'[': '_', ']': ''}) }}"
    name="{{ paramName }}"
    required
    type="file"
{% if uploadMultiple ?? false %}
    multiple
{% endif %}
/>
<script>
// https://pqina.nl/filepond/docs/api/instance/properties/
document.addEventListener('DOMContentLoaded', function() {
    window.Inachis.FileUpload.init('{{ selector|default('') }}form.filepond', {
        name: '{{ paramName }}',
        allowMultiple: {{ (uploadMultiple ?? true) ? 'true' : 'false' }},
        maxFiles: {{ maxFiles|default(1) }},
    {% if not (autoUpload ?? true) %}
        instantUpload: false,
        server: null,
        storeAsFile: true,
    {% endif %}
    {% if maxFileSize|default('') is not empty %}
        maxFilesize: '{{ maxFileSize }}',
    {% endif %}
    {% if acceptedFiles|default([]) is not empty %}
        acceptedFileTypes: {{ acceptedFiles|default([])|json_encode()|raw }},
        {% if acceptedFilesMap|default({}) is not empty %}
        fileValidateTypeLabelExpectedTypesMap: {{ acceptedFilesMap|default({})|json_encode()|raw }},
        {% endif %}
    {% endif %}
    });
});
</script>
