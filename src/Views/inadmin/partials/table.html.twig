{% block table %}
    {% if form|default(null) %}
        {{ form_start(form, {'attr': { 'class': 'form form__' ~ type ~ ' content__list' }}) }}
    {% endif %}

    {% set table_class = table_class|default('') ~ (zebra|default(false) ? ' table--striped' : '') %}
    {% set table_class = table_class ~ (show_select_deselect|default(false) ? ' table--selectable' : '') %}
    {% set table_class = table_class ~ (sortable|default(false) ? ' table--dragdrop' : '') %}

    {% if dataset|default(null) is not empty and form|default(null) is not empty %}
    {{- form_errors(form) -}}

    {{ include('inadmin/partials/filters.html.twig', {
        'show_select_deselect': false,
    }) }}
    <section class="paginated-list">
    {% if table_desc|default('') is not empty %}
    <p id="table-desc" class="visually-hidden">
        {{ table_desc }}
    </p>
    {% endif %}
    <table {%- if table_desc|default('') is not empty %} aria-describedby="table-desc"{% endif %} class="table {{ table_class|default('') }}">
        {%if table_name|default(null) %}<caption class="visually-hidden">{{ table_name }}</caption>{% endif %}
        <thead>
            <tr>
            {% if sortable is defined and sortable %}
                <th scope="col"></th>
            {% endif %}
            {% if actions|default(null) is not empty %}
                <th scope="col">
                    <label for="select-all" class="visually-hidden">Select all rows</label>
                    <input aria-label="Select all rows" class="selectAllNone" id="select-all" name="selectAllNone" type="checkbox"  />
                </th>
            {% endif %}
            {% for column in columns %}
                <th scope="col"{% if column.hideOnMobile|default(false) %} class="hide-on-mobile"{% endif %}>{{ column.title }}</th>
            {% endfor %}
            {% if sortable is defined and sortable %}
                <th scope="col">Actions</th>
            {% endif %}
            </tr>
        </thead>
        <tbody>
        {% if dataset.iterator|default(null) %}{% set dataset = dataset.iterator %}{% endif %}
        {% for item in dataset %}
            <tr>
            {% if sortable is defined and sortable %}
                <td class="handle">☰</td>
            {% endif %}
            {% if actions|default(null) is not empty %}
                <td>
                    <input class="checkbox" id="{{ type }}-{{ item.id }}__input" type="checkbox" name="items[]" value="{{ item.id }}" />
                </td>
            {% endif %}
            {% for column in columns %}
                {% if column.slug is defined %}
                    {% if '.' in column.slug %}
                        {% set slug_exploded = column.slug|split('.')  %}
                        {% set slug_object = item %}
                        {% for part in slug_exploded %}
                            {% if '[' in part %}
                                {% set part = part|split('[')[0] %}
                                {% set slug_object = attribute(slug_object, part)[0] %}
                            {% else %}
                                {% set slug_object = attribute(slug_object, part) %}
                            {% endif %}
                        {% endfor %}
                    {% else %}
                        {% set slug_object = attribute(item, column.slug) %}
                    {% endif %}
                {% endif %}
                <{% if column.header is defined and column.header %}th scope="row"{% else %}td{% if column.flex|default(false) %} class="table--flex"{% endif %}{% if column.hideOnMobile|default(false) %} class="hide-on-mobile"{% endif %}{% if column.className is defined %} class="{{ column.className == 'use_self' ? attribute(item, column.source) : column.className }}"{% endif %}{% endif %}>
                    {% if column.slug is defined %}
                        <a aria-label="Edit {{ attribute(item, column.source) }}" href="/incc/{{ slug_prefix }}/{{ slug_object }}">
                    {% endif %}
                    {% if column.url is defined and column.url is not empty %}
                            <a aria-label="Edit {{ attribute(item, 'title') }}" href="{{ attribute(item, column.url) }}">
                    {% endif %}
                    {% if column.source is defined and attribute(item, column.source) is defined %}
                        {% if column.source_type is defined and column.source_type == 'date' %}
                            {{ attribute(item, column.source)|date('d/m/Y') }}
                        {% elseif column.source_type is defined and column.source_type == 'title' %}
                            {{ attribute(attribute(item, column.source), 'title') }}
                        {% else %}
                            {% if column.maxLength is defined %}
                                {{ attribute(item, column.source)|slice(0, column.maxLength) }}
                                {% if attribute(item, column.source)|length > 300 %}…{% endif %}
                            {% else %}
                                {{ attribute(item, column.source) }}
                            {% endif %}
                        {% endif %}
                    {% elseif column.badges|default(null) is not empty %}
                        {% include 'inadmin/partials/badge.html.twig' with {
                            badges: column.badges,
                        } %}
                    {% endif %}
                    {% if column.slug is defined or (column.url is defined and column.url is not empty) %}
                        </a>
                    {% endif %}
                </{% if column.header is defined and column.header %}th{% else %}td{% endif %}>
            {% endfor %}
            {% if sortable is defined and sortable %}
                <td>
                    {% if not loop.first %}<button class="move-up">↑</button>{% endif %}
                    {% if not loop.last %}<button class="move-down">↓</button>{% endif %}
                </td>
            {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% if show_pagination is not defined or show_pagination %}
        {{ include('inadmin/partials/pagination.html.twig', {
            offset: offset,
            limit: limit,
            maxResults: total,
            maxPagesToShow: 4,
            result_url: url_result,
            total: total,
        }) }}
    {% endif %}
    </section>
        {% if actions|default(null) is not empty %}
            {% include 'inadmin/partials/action_bar.html.twig' %}
        {% endif %}
    {% elseif filter_values|default(null) is not empty %}
        {% include 'inadmin/partials/filters.html.twig' with {
            'filters': filters,
            'filter_values': filter_values,
            'show_search': show_search
        } only %}
        <section class="paginated-list">
            <p class="content-warning">
                <i class="material-icons" aria-hidden="true">info_outline</i>
                <span>Oops! Your filter didn't find anything!</span>
            </p>
        </section>
    {% else %}
        <section class="paginated-list">
            <p class="content-warning">
                <i class="material-icons" aria-hidden="true">info_outline</i>
                <span>You don't have any content yet!</span>
                {% if add_button is defined and add_button.url is defined %}
                    <a href="{{ add_button.url }}">Add some now!</a>
                {% endif %}
            </p>
        </section>
    {% endif %}

    {% if form|default(null) %}
        {{ form_end(form, render_rest: false) }}
    {% endif %}
{% endblock table %}